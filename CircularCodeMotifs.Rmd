---
title: "On Mutations in Circular Code Motifs"
output: html_notebook
---

zuerst Bibliotheken laden
```{r}
library(Biostrings)
```

Untersucht wird die DNA des Sars-Virus
```{r}
seqSet = readDNAStringSet("cds/ena-sars.fasta")
seq=seqSet[[11]]
```

Circular Codes werden aus einer Textdatei gelsen
```{r}
source("ccmotif/R/codes.R")
cCodes = ccmotif.readCodes("ccmotif/C3.txt")
setX = cCodes[27]
```

Für den späteren Vergleich wird die Aminosäuresequenz ermittelt, welche durch die RNA Sequenz codiert wird. 

```{r}
aa=translate(seq)
print(aa)
```
Nun wird jedes Codon einzeln betrachtet: 
- Ist das Codon Teil des Circular Codes muss keine Veränderung vorgenommen werden. 
- Ist das Codon nicht Teil des Circular Codes wird es in die Aminosäure übersetzt, über welche eine Liste an Codons ermittelt wird, die für dieselbe Aminosäure codieren. Durch diese Liste wird iteriert:
-- beinhaltet die Liste ein Codon des Circular Codes wird das ursprüchliche Codon durch das gefundene ersetzt
-- ist vorheriges nicht der Fall, wird über eine Blossum/Pam Matrix eine ähnliche Aminosäure ermittelt. Für diese wird nun wieder eine Liste mit Codons zurückgegeben und das Spiel wiederholt sich.

TODO: Punktesystem einführen:
gute Wertung: einfache Punktmutation für selbe Aminosäure
mittlere Wertung: Aminosäuretausch via Blossum Matrix
schlechte Wertung: Aminosäuretausch mit weiter entfernter AS auf Blossum Matrix
(evtl Scoring System der Blossum Matrix miteinbeziehen)

TODO: Deltion beachten --> manchmal am günstigsten

```{r}
source("AminoDecoder.R")
newSequence = changeSequence(seq, setX)

print(setX) #circular code
print(toString(seq)) #oldSequence
print(newSequence)

counts = getStatistics()
print(paste("Insgesamt gab es", counts[1],"Codons."))
print(paste(counts[2],"Waren nicht bereits Teil des ciruclar Codes."))
print(paste("Davon wurden",counts[3],"ersetzt durch Codons, welche Teil des cirular Codes sind und für dieselbe Aminosöure codieren."))

fileConn = file("output.txt") #newSequence to txt file
writeLines(newSequence, fileConn) 
close(fileConn)
```

Da eine Aminosäure-Austausch noch nicht implementiert ist, sollte die Sequenz dieselbe sein.
```{r}
oldAAseq = translate(seq)
newSequenceString = toString(newSequence)
newSequenceDNA = DNAString(newSequenceString)
newAASeq = translate(newSequenceDNA)
oldAAseq == newAASeq #compare amino acid sequences
```


